import json
import unittest

import inspector_parser


def get_inspector_json(file):
    inspector_json = ""
    with open(file, "r") as f:
        inspector_json = json.load(f)
    return inspector_json


class TestInspectorParser(unittest.TestCase):

    def test_get_summarized_findings(self):
        inspector_scan = get_inspector_json("test_data/scan.json")
        findings = inspector_parser.get_summarized_findings(inspector_scan)
        for finding in findings:
            self.assertTrue(finding.package_names != "")
            self.assertTrue(finding.vulnerability_id != "")
            self.assertTrue(finding.cvss_severity != "")
            self.assertTrue(finding.cvss_score != "")
            self.assertTrue(finding.installed_versions != "")
            # self.assertTrue(finding.fixed_version != "")
            self.assertTrue(finding.analysis_state != "")
            self.assertTrue(finding.advisories != "")


if __name__ == '__main__':
    unittest.main()
