name: 'Amazon Inspector SBOM Generator'
description: 'Generate SBOMs and scan for vulnerabilities in your project repository or build artifacts'
inputs:
  artifact:
    description: 'The artifact you would like to scan with Amazon Inspector. Valid choices are "repository", "container", "binary", or "archive".'
    required: true
    default: 'repository'

  image:
    description: 'The container image you would like to scan with Amazon Inspector. The provided value must follow the docker pull convention: "NAME[:TAG|@DIGEST]"'
    required: false
    default: ''

  binary:
    description: 'The path to a compiled Go or Rust binary that you would like to scan with Amazon Inspector. Packed or obfuscated binaries are not supported.'
    required: false
    default: ''

runs:
  using: 'docker'
  image: 'Dockerfile'
  args:
    - ${{ inputs.artifact }}
    - ${{ inputs.image }}

